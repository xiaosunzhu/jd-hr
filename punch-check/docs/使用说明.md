## 排班打卡比对工具使用说明 ##
版本：0.0.4  
Copyright 2015 yijun.sun

### 快速使用 ###
1. 编辑config目录下的“数据配置.ini”文件，根据需要修改年、月和起始月。
2. 双击运行"punch_check.exe"。
3. 当提示输入“排班表”时，拖拽排班表文件到运行窗口中，点击运行窗口，键入回车。
4. 当提示输入“打卡表”时，拖拽打卡表文件到运行窗口中，点击运行窗口，键入回车。
5. 当提示“处理完毕”，表示处理成功，已生成比对后的文件到当前目录。
6. 根据提示键入回车退出运行窗口。
********************************************************************

### 详细说明 ###

#### 1. 配置 ####
配置文件以“.ini”为后缀，放置于config目录下。  
以#开头的文字为说明部分  
配置文件基本格式：  
[配置段]  
配置项=值  
>*注意：需要保证所有配置文件的编码格式不变。*

**各配置项说明**  

* 数据配置.ini  
  * “Base”配置段  （基础配置，**每次会变更**）  
   年：当前年份，4位数字  
   月：考勤月份  
   起始月：考勤周期起始月份  
     >*例如：4月考勤周期为3月21号-4月20号，月=4，起始月=3*  
  * “Swtiches”配置段  （执行方式开关，值为数字，0表示关闭，1表示启用）  
   全局排班：是否使用全局统一的排班代码配置。如果关闭，需要配置每个部门的排版代码。

* 排班代码配置.ini  
    >*注意配置文件的说明部分，并严格按照原有格式修改，注意所有符号（-,:等）均为英文输入法。*
  * “请假”配置段  
   所有需要输出的假别需要在此列出。  
   格式为：代码 = 描述,起始时间-截止时间
  * “Global”配置段  
   全局统一的排班代码配置。当“数据配置.ini”中的“全局排班”配置开启（=1）时生效。  
   格式为：代码 = 起始时间-截止时间
  * 其他配置段
   当“数据配置.ini”中的“全局排班”配置关闭（=0）时生效。  
   具体格式详见配置文件中的说明。  
    >*“请假”和“Global”配置段是固定的，其他配置段根据部门自行设定*

* 表格配置.ini
    *该配置仅在表格格式发生变化时才进行修改。*   
   Sheet：处理第几个Sheet  
   其他配置项不做详细说明。
  

#### 2. 准备输入表格 ####
* 排班表  
  保证所有人员均包含；  
  日期是按照顺序排列的；  
  排班代码符合“排班代码配置.ini”中的配置（统一采用大写字母）。
* 打卡表  
  保证排班表中的所有人员均有打卡记录；  
  打卡日期和打卡时间拆分为2列；  
  保证打卡记录中的人员与排班表中的人员一一匹配。
  
  
#### 3. 运行输出 ####
使用步骤见开头的“快速使用”。  
如果运行窗口提示“程序异常！”，则说明处理失败，请联系开发者。（具体原因在“程序异常！”前面有提示，请将运行窗口中的所有内容发送到<dusunjun@126.com>）  
成功处理完毕后，会生成一个Excel文件（排班打卡比对_XXXX年X月.xls）。  
*********************************************************************

### 输出文件说明 ###
该文件包含4个表格：  
第一个表格是与“考勤异常表”近似的表格；  
第二个表格是每个人每天的排班上班信息；  
第三个表格是可能有异常的所有打卡记录；  
第四个表格是在打卡表中有打卡记录但是排班表中没有任何排班信息的人员。

* “考勤异常”Sheet  
   “排班链接”列：链接到该异常对应日期的排班上班信息行。
   “状态”列：没有内容。在一个人员某天既没有打上班又没有打下班卡时，会标记为红色背景，**可能是有排班表没有登记的请假**。
* “TimeInfo”Sheet  
   “在班时间”列：不准确的上班持续时间，仅供参考。  
   “排班”列：绝对准确的当天排班，包括排班代码和时间段。  
   “异常信息”列：包括上班未打卡/下班未打卡/迟到/早退。没有异常的为空，有异常的行有背景色，未打卡为紫红色，迟到或早退为黄色。**如果连续多行都有异常，则可能是打卡信息与排班信息不太匹配。**
   “详细链接”列：链接到“Details”Sheet中与当天异常相关的打卡信息附近行。
* “Details”Sheet
   “返回链接”列：如果是没有信息的人员，则链接到“NotPlan”Sheet；如果是打卡异常，则链接到“TimeInfo”Sheet。  
   “排班”列：非完全准确的打卡记录的排班划分，仅供参考。
* “NotPlan”Sheet  
   ”详细链接“列链接到“Details”Sheet。