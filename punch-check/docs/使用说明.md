## Punch Check 使用说明 ##
版本：0.4.*  
Copyright 2015 yijun.sun
********************************************************************

### 快速使用 ###
1. 编辑config目录下的“数据配置.ini”文件，根据需要修改年、月和起始月。
2. 双击运行"punch_check.exe"。
3. 如果提示有新版本，可以键入回车查看更新信息，或者键入“n”后回车，跳过查看。
4. 当提示输入“排班表”时，拖拽排班表文件到运行窗口中，点击运行窗口，键入回车。
5. 当提示输入“打卡表”时，拖拽打卡表文件到运行窗口中，点击运行窗口，键入回车。
6. 当提示“输入起始日期”时，请比对提示的起始日期，如果不需要变更，则直接键入回车，如果需要设定，则输入日期，格式为“年-月-日”，例如“2015-3-18”，键入回车。
7. 当提示“输入截止日期”时，请比对提示的截止日期，如果不需要变更，则直接键入回车，如果需要设定，则输入日期，格式为“年-月-日”，例如“2015-3-18”，键入回车。
8. 当提示“处理完毕”，表示处理成功，已生成比对后的文件“排班打卡比对_XXXX年X月.xls”到当前目录。
9. 根据提示键入回车退出运行窗口。
********************************************************************

#### 1. 准备待处理文件 ####
包括**排班表**和**打卡表**，文件名和路径没有要求。  
文件格式要求详见参考手册“处理文件要求”段。

#### 2. 修改配置参数 ####

>*\#开头的为说明文字，与配置无关*

  1. **配置考勤时间**  
  “config\数据配置.ini”文件右键-编辑，修改“年”、“月”、“起始月”数字，保存，关闭。  

		例如：2015年4月考勤周期为3月21号-4月20号
		年 = 2015
		月 = 4
		起始月 = 3
  
  2. **配置使用统一的排班代码**  
  “config\数据配置.ini”文件右键-编辑，修改“全局排班”数字为1，保存，关闭。

		修改如下：
		全局排班 = 1
  
  3. **配置使用部门单独的排班代码**  
  “config\数据配置.ini”文件右键-编辑，修改“全局排班”数字为0，保存，关闭。

		修改如下：
		全局排班 = 0

	>*统一排班、部门单独排班 只能选择一种*
  
  4. **打开表不拆分日期时间列**  
  “config\数据配置.ini”文件右键-编辑，修改“打卡日期时间不拆分”数字为1，保存，关闭。

		修改如下：
		打卡日期时间不拆分 = 1

	>*注意修改“config\表格配置.ini”中“打卡表”后面的“类型列”的数字*

  5. **配置排班代码**  
  一般不需要修改排班代码。  
  “config\排班代码配置.ini”文件右键-编辑。  
    * 修改假别配置：在[请假]下面修改。添加代码则添加一行，修改代码的描述或时间则在原有行做修改，删除代码则将对应行删除即可。

			例如：修改年假的描述为带薪年假，时间为9:00-18:00
			找到原来配置年假的行：N = 年假,5:00-14:00，改为：
			N = 带薪年假,9:00-18:00
			如果需要删除年假，则将N = 年假,5:00-14:00这一行删除。
			**
			如果需要配置不检测的代码如休假，不配置时间即可。如：
			休 = 休假,
			**
    
    * 修改统一的排班代码配置：在[Global]下面修改。添加代码则添加一行，修改代码的描述或时间则在原有行做修改，删除代码则将对应行删除即可。

			例如：修改E班时间时间为14:00-20:00
			找到原本已有E班配置E = 12:00-21:00，那么将本行改为：
			E = 14:00-20:00
			如果原本没有E = 的配置，则在[Global]下面任意添加一行即可。

    * 修改分部门排班代码配置：需要先找到有没有对应的[部门名称]，如果没有，则在文件最后添加[部门名称]，并在后面添加该部门的排班代码配置。如果已有对应的[部门名称]，则在原有[部门名称]后面修改排班代码配置。部门名称与排班表的部门一致。

			例如：添加一个排班表里面的部门“调度”，并添加调度部门的一个排班代码1，时间段为9:00-18:00
			在文件末尾添加：
			[调度]
		    1 = 9:00-18:00

    * 修改需要统计的排班配置：在[统计]下面修改。如果不需要统计，则不需要配置。如果要添加一种统计类别，则添加一行即可，需要配置属于该统计类别的排班代码。

			例如：需要统计大夜班次数，而大夜班包括TS、ZS、CS，则在[统计]下面添加一行：
		    大夜班 = TS,ZS,CS

#### 3. 运行程序 ####
双击运行"punch_check.exe"。

#### 4. 分析输出文件 ####

1. 查看“考勤异常”Sheet  
  **旷工**或**未登记的请假**：状态列标记为红色，表示一天两次未打卡。
	>尤其是连续的2行及以上的红色，极可能是请假或离职没有在排班表登记。

2. 查看“TimeInfo”Sheet：  
  * **排班时间配置可能有误**：出现过多的黄色或紫红色背景，筛选“异常信息”非空白列，如果“排班”集中出现一种排班代码，则可能该代码的时间段配置有误。
  * **某人排班可能有误**：打卡时间背景为青色或者一个人员的所有排班中连续或集中几行出现黄色背景，则可能该人员的排班信息有误。
  * **打卡表缺少某人打卡信息**或者**打卡表ERP与排班表不匹配**：连续出现5行以上的紫红色背景。检查如果该人员所有排班行都是紫红色背景，则打卡表中无匹配的ERP。    
	>若对异常情况需要人工判定结果，可以通过链接到“Details”Sheet查看该异常的前一天、当天、后一天的所有打卡记录。

3. 查看“统计”Sheet：  
  该表格包括所有人员的统计次数，如果没有配置，则不会输出该Sheet。每种统计包含排班次数和实际打卡次数，实际打卡次数在旷工的情况下与排班次数不一致。

4. 查看“NotPlan”Sheet：  
  该表格中出现的人员可能是**排班表遗漏人员**，也有可能与**打卡表ERP与排班表不匹配**相关，可以相互参考。  
	>可以通过链接到“Details”Sheet查看该人员的所有打卡记录。
